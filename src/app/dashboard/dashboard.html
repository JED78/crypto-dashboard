<div class="min-h-screen w-full bg-gradient-to-b from-white to-blue-100 p-8 flex flex-col items-center animate-fade-in">

  <!-- TÍTULO -->
  <h1 class="text-4xl font-bold text-blue-700 mb-8 drop-shadow-sm animate-slide-down">
    Crypto Dashboard (Binance)
  </h1>

  <!-- CONTROLES -->
  <div class="controls flex flex-wrap gap-6 justify-center mb-10 
              bg-white/60 backdrop-blur-md p-6 rounded-xl shadow-lg 
              border border-white/40 animate-fade-in-up">

    <!-- CRIPTOMONEDA -->
    <mat-form-field *ngIf="allCryptos.length > 0" appearance="fill" class="w-48">
      <mat-label>Criptomoneda</mat-label>
      <mat-select [(value)]="selectedCrypto" (selectionChange)="onSelectionChange()">
        <mat-option *ngFor="let c of allCryptos" [value]="c">{{ c }}</mat-option>
      </mat-select>
    </mat-form-field>

    <!-- MONEDA QUOTE -->
    <mat-form-field *ngIf="allQuotes.length > 0" appearance="fill" class="w-48">
      <mat-label>Moneda</mat-label>
      <mat-select [(value)]="selectedQuote" (selectionChange)="onSelectionChange()">
        <mat-option *ngFor="let q of allQuotes" [value]="q">
          {{ q }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <!-- REFRESCO -->
    <mat-form-field appearance="fill" class="w-48">
      <mat-label>Refresco</mat-label>
      <mat-select [value]="selectedRefresh" (selectionChange)="onSelectionChange($event.value)">
        <mat-option *ngFor="let r of refreshOptions" [value]="r.value">
          {{ r.label }}
        </mat-option>
      </mat-select>
    </mat-form-field>

  </div>

  <!-- PRECIO ACTUAL -->
  <div class="current text-center mb-10 animate-fade-in-up">
    <h2 class="text-3xl font-semibold text-blue-800 mb-2">
      {{ selectedCrypto }}/{{ selectedQuote }}
    </h2>

    <p *ngIf="currentPrice !== undefined; else loading"
       class="text-xl font-medium text-gray-700">
      Precio actual:
      <span class="text-blue-600 font-bold">
        {{ currentPrice | number: '1.2-2' }}
      </span>
    </p>

    <p *ngIf="lastUpdate" class="text-sm text-gray-600 mt-1">
      Última actualización: {{ lastUpdate | date: 'HH:mm:ss' }}
    </p>
  </div>

  <ng-template #loading>
    <span class="text-gray-500 animate-pulse">Cargando...</span>
  </ng-template>

  <!-- GRÁFICA DE PRECIO -->
  <div class="chart-container w-full max-w-4xl bg-white/70 backdrop-blur-md
              p-6 rounded-xl shadow-xl animate-fade-in-up mb-8">
    <canvas 
      class="bg-white"
      baseChart
      [data]="chartData"
      [options]="chartOptions"
      [type]="'line'">
    </canvas>
  </div>

  <!-- ⭐ GRÁFICA DE VOLUMEN -->
  <div class="chart-container w-full max-w-4xl bg-white/70 backdrop-blur-md
              p-6 rounded-xl shadow-xl animate-fade-in-up mb-8">
    <canvas 
      class="bg-white"
      baseChart
      [data]="chartVolumeData"
      [options]="chartVolumeOptions"
      [type]="'bar'">
    </canvas>
  </div>

  <!-- ⭐ GRÁFICA DE RSI -->
<div class="chart-container w-full max-w-4xl bg-white/70 backdrop-blur-md
            p-6 rounded-xl shadow-xl animate-fade-in-up mt-8">
  <canvas 
    class="bg-white"
    baseChart
    [data]="chartRsiData"
    [options]="chartRsiOptions"
    [type]="'line'">
  </canvas>
</div>


<!-- ⭐ GRÁFICA TOP 5 SUBIDAS MENSUALES -->
<div class="chart-container w-full max-w-4xl bg-white/70 backdrop-blur-md
            p-6 rounded-xl shadow-xl animate-fade-in-up mt-8">
  <canvas 
    class="bg-white"
    baseChart
    [data]="chartTop5Data"
    [options]="chartTop5Options"
    [type]="'bar'">
  </canvas>
</div>

<!-- ⭐ RESUMEN DIARIO DEL MERCADO -->
<div class="w-full max-w-4xl bg-white/70 backdrop-blur-md
            p-6 rounded-xl shadow-xl animate-fade-in-up mb-8 mt-12">

  <h2 class="text-2xl font-semibold text-blue-800 mb-8">
    Resumen diario del mercado
  </h2>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-gray-700">

    <div>
      <p class="text-sm font-medium text-gray-500">BTC 24h</p>
      <p [ngClass]="dailySummary.btcChange >= 0 ? 'text-green-600' : 'text-red-600'"
         class="text-xl font-bold">
        {{ dailySummary.btcChange | number:'1.2-2' }} %
      </p>
    </div>

    <div>
      <p class="text-sm font-medium text-gray-500">ETH 24h</p>
      <p [ngClass]="dailySummary.ethChange >= 0 ? 'text-green-600' : 'text-red-600'"
         class="text-xl font-bold">
        {{ dailySummary.ethChange | number:'1.2-2' }} %
      </p>
    </div>

    <div>
      <p class="text-sm font-medium text-gray-500">Tendencia del mercado</p>
      <p class="text-xl font-bold text-blue-700">
        {{ dailySummary.market }}
      </p>
    </div>

  </div>

  <div class="mt-4 border-t border-gray-200 pt-4">
    <p class="text-sm font-medium text-gray-500">Cripto destacada del día</p>
    <p class="text-lg font-semibold text-gray-800">
      {{ dailySummary.topSymbol || 'Calculando...' }}
      <span *ngIf="dailySummary.topSymbol"
            [ngClass]="dailySummary.topChange >= 0 ? 'text-green-600' : 'text-red-600'">
        ({{ dailySummary.topChange | number:'1.2-2' }} %)
      </span>
    </p>
  </div>

 <!-- ⭐ DETECTOR DE TENDENCIAS -->
<div class="w-full max-w-4xl bg-white/70 backdrop-blur-md
            p-6 rounded-xl shadow-xl animate-fade-in-up mb-8 mt-16">

  <h2 class="text-2xl font-semibold text-blue-800 mb-4">
    Detector de tendencias
  </h2>

  <div *ngIf="trendList.length; else loadingTrends"
       class="space-y-2 text-gray-700">

    <div *ngFor="let t of trendList"
         class="flex items-center justify-between border-b border-gray-200 pb-2 last:border-b-0">

      <span class="font-semibold text-gray-800">
        {{ t.symbol }}
      </span>

      <span class="text-sm text-gray-500">
        {{ t.trend }}
      </span>

      <span [ngClass]="t.change >= 0 ? 'text-green-600' : 'text-red-600'"
            class="text-sm font-semibold">
        {{ t.change | number:'1.2-2' }} %
      </span>
    </div>

  </div>

  <ng-template #loadingTrends>
    <p class="text-gray-500 text-sm">Calculando tendencias...</p>
  </ng-template>
</div>
  <!-- ⭐ OPORTUNIDADES DEL DÍA -->
<div class="w-full max-w-4xl bg-white/70 backdrop-blur-md
            p-6 rounded-xl shadow-xl animate-fade-in-up mb-8 mt-16">

  <h2 class="text-2xl font-semibold text-blue-800 mb-4">
    Oportunidades del día
  </h2>

  <div *ngIf="opportunities.length; else loadingOpps"
       class="space-y-3 text-gray-700">

    <div *ngFor="let o of opportunities"
         class="flex items-center justify-between border-b border-gray-200 pb-2 last:border-b-0">

      <span class="font-semibold text-gray-800">
        {{ o.symbol }}
      </span>

      <span class="text-sm text-gray-500">
        {{ o.reason }}
      </span>

      <span [ngClass]="{
              'text-green-600': o.type === 'bullish',
              'text-red-600': o.type === 'bearish',
              'text-gray-600': o.type === 'neutral'
            }"
            class="text-sm font-semibold">
        {{ o.value | number:'1.1-1' }}
      </span>
    </div>

  </div>

  <ng-template #loadingOpps>
    <p class="text-gray-500 text-sm">Buscando oportunidades...</p>
  </ng-template>

</div>
</div>